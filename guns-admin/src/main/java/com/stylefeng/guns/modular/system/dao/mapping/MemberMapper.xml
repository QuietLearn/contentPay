<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stylefeng.guns.modular.system.dao.MemberMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.stylefeng.guns.modular.system.model.Member">
        <id column="id" property="id" />
        <result column="username" property="username" />
        <result column="nickname" property="nickname" />
        <result column="password" property="password" />
        <result column="Md5_password" property="md5Password" />
        <result column="gender" property="gender" />
        <!--<result column="introduction" property="introduction" />-->
        <result column="pic_address" property="picAddress" />
        <result column="mobile" property="mobile" />
        <!--<result column="focus_count" property="focusCount" />
        <result column="fans_count" property="fansCount" />
        <result column="hit_count" property="hitCount" />-->
        <result column="qq" property="qq" />
        <result column="weixin" property="weixin" />
        <result column="email" property="email" />
        <result column="member_type_id" property="memberTypeId" />
        <result column="member_type_name" property="memberTypeName" />
        <result column="vip_level" property="vipLevel" />
        <result column="buy_time" property="buyTime" />
        <result column="end_time" property="endTime" />
        <result column="aging" property="aging" />
        <result column="points" property="points" />
       <!-- <result column="user_level" property="userLevel" />
        <result column="experience" property="experience" />-->
        <result column="favorites_ids" property="favoritesIds" />
        <result column="last_login" property="lastLogin" />
        <result column="last_loginIp" property="lastLoginip" />
        <result column="register_time" property="registerTime" />
        <result column="register_ip" property="registerIp" />
        <result column="UUID_token" property="uuidToken" />
        <result column="total_money" property="totalMoney" />
        <result column="is_lock" property="isLock" />
        <result column="is_del" property="isDel" />
       <!-- <result column="gmt_receive" property="gmtReceive" />-->
        <result column="gmt_created" property="gmtCreated" />
        <result column="gmt_modified" property="gmtModified" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        /* introduction,focus_count, fans_count, hit_count, user_level, experience ,gmt_receive*/
        id, username, nickname, password, Md5_password, gender, pic_address, mobile, qq, weixin, email, member_type_id, member_type_name, vip_level, buy_time, end_time, aging, points, favorites_ids, last_login, last_loginIp, register_time, register_ip, UUID_token, total_money, is_lock, is_del, gmt_created, gmt_modified
    </sql>

    <select id="checkName" parameterType="string" resultType="int">
        select count(1)
        from cps_member
        where username = #{name}
    </select>

    <select id="checkEmail" parameterType="string" resultType="int">
        select count(1)
        from cps_member
        where email = #{email}
    </select>

    <update id="updateGmtLastLoginAndLastIp" parameterType="String">
      update cps_member
      <set>
          <if test="last_loginIp!=null">

          </if>
      </set>
    </update>

    <select id="login" parameterType="map" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>
        from cps_member
        where username = #{username}
        and Md5_password = #{md5Password}
    </select>

    <select id="selectMemberByUsername" parameterType="string" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>
        from cps_member
        where username = #{username}
    </select>

    <select id="selectMemberByUuidToken" parameterType="string" resultMap="BaseResultMap">
      select <include refid="Base_Column_List"/>
      from cps_member
      where UUID_token = #{uuidToken}
    </select>

    <update id="updateUuidById" parameterType="com.stylefeng.guns.modular.system.model.Member">
        update cps_member
        set UUID_token = #{uuidToken,jdbcType=VARCHAR}
       where id = #{id,jdbcType=INTEGER}
    </update>

    <select id="selectMemberByMobile" parameterType="string" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>
        from cps_member
        where mobile = #{mobile}
    </select>

    <select id="loginByMobile" parameterType="map" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/>
        from cps_member
        where mobile = #{mobile}
        and Md5_password = #{md5Password}
    </select>
</mapper>
